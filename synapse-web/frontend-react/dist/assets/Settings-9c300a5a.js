import{u as N,j as e,E as _,A as w}from"./index-d3d76560.js";import{r as l,c as u}from"./vendor-d6de9d8b.js";import{u as S}from"./useMutation-a48fd688.js";import{u as I,a as x}from"./api-36b40c7e.js";import{C as A}from"./CheckCircleIcon-27af60e8.js";import"./router-41a8dd64.js";function C({title:s,titleId:n,...i},o){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":n},i),s?l.createElement("title",{id:n},s):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const M=l.forwardRef(C),E=M;function D(){const{data:s,isLoading:n}=I("settings",x.system.getSettings),[i,o]=l.useState(!1),[t,d]=l.useState(null),[c,p]=l.useState(!1),[h,f]=l.useState([]),b=N();u.useEffect(()=>{if(s&&!t&&(d({...s}),s.available_models))try{const a=JSON.parse(s.available_models);f(a)}catch(a){console.error("Failed to parse available models:",a)}},[s,t]);const g=u.useMemo(()=>t?.default_provider?h.filter(a=>a.provider===t.default_provider):[],[h,t?.default_provider]),y=S((a=!1)=>{if(!t?.default_provider||!t.api_key)throw new Error("Provider and API key required");return x.system.fetchModels(t.default_provider,t.api_key,a)},{onSuccess:a=>{if(f(a.models),t){const m={...t,available_models:JSON.stringify(a.models),models_last_fetched:a.cached_at};d(m)}},onError:a=>{console.error("Failed to fetch models:",a)}});u.useEffect(()=>{t?.default_provider&&t.api_key&&y.mutate(!1)},[t?.default_provider,t?.api_key]);const j=async()=>{if(t){o(!0);try{await x.system.updateSettings(t),await b.invalidateQueries("settings")}catch(a){console.error("Failed to save settings:",a)}finally{o(!1)}}},k=async()=>{p(!0);try{await y.mutateAsync(!0)}finally{p(!1)}},r=(a,m)=>{d(v=>v?{...v,[a]:m}:null)};return n||!t?e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsx("div",{className:"text-gray-500",children:"Loading settings..."})}):e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Settings"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Configure your Synapse preferences and AI provider settings."}),e.jsxs("div",{className:"mt-8 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"AI Provider Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Default Provider"}),e.jsxs("select",{className:"input",value:t?.default_provider||"openai",onChange:a=>r("default_provider",a.target.value),children:[e.jsx("option",{value:"openai",children:"OpenAI"}),e.jsx("option",{value:"claude",children:"Claude"}),e.jsx("option",{value:"gemini",children:"Gemini"}),e.jsx("option",{value:"openrouter",children:"OpenRouter"}),e.jsx("option",{value:"mock",children:"Mock (for testing)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),e.jsx("input",{type:"password",className:"input",placeholder:"Enter your API key",value:t?.api_key||"",onChange:a=>r("api_key",a.target.value)})]}),e.jsxs("div",{className:"mt-4 p-3 rounded-lg border",children:[t?.api_key?.trim()?e.jsxs("div",{className:"flex items-center space-x-2 text-green-700 dark:text-green-300",children:[e.jsx(A,{className:"h-5 w-5"}),e.jsxs("span",{className:"text-sm",children:[t.default_provider," provider is configured"]})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-amber-700 dark:text-amber-300",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsxs("span",{className:"text-sm",children:["API key required for ",t?.default_provider||"selected"," provider"]})]}),t?.default_provider&&e.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(E,{className:"h-5 w-5 text-blue-500 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsxs("strong",{children:[t.default_provider," Setup:"]}),t.default_provider==="openai"&&e.jsxs("p",{className:"mt-1",children:["Get your API key from ",e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"OpenAI Platform"})]}),t.default_provider==="claude"&&e.jsxs("p",{className:"mt-1",children:["Get your API key from ",e.jsx("a",{href:"https://console.anthropic.com/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Anthropic Console"})]}),t.default_provider==="gemini"&&e.jsxs("p",{className:"mt-1",children:["Get your API key from ",e.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Google AI Studio"})]}),t.default_provider==="openrouter"&&e.jsxs("p",{className:"mt-1",children:["Get your API key from ",e.jsx("a",{href:"https://openrouter.ai/keys",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"OpenRouter Keys"})]}),t.default_provider==="mock"&&e.jsx("p",{className:"mt-1",children:"Mock provider for testing - no API key required"})]})]})})]}),g.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Default Model"}),e.jsxs("select",{className:"input",value:t?.selected_model||"",onChange:a=>r("selected_model",a.target.value),children:[e.jsx("option",{value:"",children:"Auto-select best model"}),g.map(a=>e.jsxs("option",{value:a.id,children:[a.name," (",a.context_limit?.toLocaleString()||"Unknown"," tokens)"]},a.id))]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:t?.models_last_fetched?`Models cached: ${new Date(t.models_last_fetched).toLocaleString()}`:"No models cached"}),e.jsxs("button",{type:"button",onClick:k,disabled:c||!t?.api_key,className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 disabled:opacity-50 flex items-center space-x-1",children:[e.jsx(w,{className:`h-3 w-3 ${c?"animate-spin":""}`}),e.jsx("span",{children:c?"Refreshing...":"Refresh"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Analysis Timeout (seconds)"}),e.jsx("input",{type:"number",className:"input",min:"60",max:"1800",value:t?.analysis_timeout_seconds||300,onChange:a=>r("analysis_timeout_seconds",parseInt(a.target.value)||void 0)}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Set analysis timeout (60-1800 seconds, default: 300)"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Analysis Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Log Lines to Analyze"}),e.jsx("input",{type:"number",className:"input",min:"100",max:"10000",value:t?.max_lines||1e3,onChange:a=>r("max_lines",parseInt(a.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Default Log Level"}),e.jsxs("select",{className:"input",value:t?.default_level||"INFO",onChange:a=>r("default_level",a.target.value),children:[e.jsx("option",{value:"ERROR",children:"Error"}),e.jsx("option",{value:"WARN",children:"Warning"}),e.jsx("option",{value:"INFO",children:"Info"}),e.jsx("option",{value:"DEBUG",children:"Debug"})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"UI Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Show timestamps"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t?.show_timestamps||!0,onChange:a=>r("show_timestamps",a.target.checked)}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Show line numbers"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t?.show_line_numbers||!0,onChange:a=>r("show_line_numbers",a.target.checked)}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:j,disabled:i,className:"btn-primary",children:i?"Saving...":"Save Settings"})})]})]})}export{D as default};
