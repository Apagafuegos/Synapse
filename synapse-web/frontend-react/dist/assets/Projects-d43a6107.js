import{u as M,j as e,L as _,A,F as b}from"./index-d3d76560.js";import{r as n}from"./vendor-d6de9d8b.js";import{u as N}from"./useMutation-a48fd688.js";import{u as T,a as m}from"./api-36b40c7e.js";import{L as $}from"./router-41a8dd64.js";import{P as v}from"./PlusIcon-fa0a24a4.js";function B(){const[a,w]=n.useState(""),[k,l]=n.useState(!1),[s,c]=n.useState({name:"",description:""}),[i,x]=n.useState(!1),[o,p]=n.useState(!1),[h,r]=n.useState(null),u=M(),{data:C,isLoading:P,error:d,refetch:S}=T("projects",m.projects.getAll),L=N(t=>m.projects.create(t),{onSuccess:()=>{u.invalidateQueries("projects"),l(!1),c({name:"",description:""}),r(null)},onError:t=>{r(t.message||"Failed to create project")}}),I=N(()=>m.post("/projects/sync"),{onSuccess:t=>{u.invalidateQueries("projects");const{synced:g,errors:f}=t;g>0&&r(null),f>0&&r(`Synced ${g} projects, but encountered ${f} errors`)},onError:t=>{r(t.message||"Failed to sync CLI projects")}}),j=C?.filter(t=>t.name.toLowerCase().includes(a.toLowerCase())||t.description?.toLowerCase().includes(a.toLowerCase()))||[],E=async()=>{if(!s.name.trim()){r("Project name is required");return}x(!0);try{await L.mutateAsync({name:s.name.trim(),description:s.description.trim()||void 0})}catch{}finally{x(!1)}},y=()=>{l(!1),c({name:"",description:""}),r(null)},F=async()=>{p(!0);try{await I.mutateAsync()}catch{}finally{p(!1)}};return P?e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsx(_,{size:"lg"})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Projects"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Manage your log analysis projects and track their progress."})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{type:"button",className:"btn-secondary",onClick:F,disabled:o,title:"Import CLI projects from workspace",children:[e.jsx(A,{className:`h-4 w-4 mr-2 ${o?"animate-spin":""}`,"aria-hidden":"true"}),o?"Syncing...":"Sync CLI Projects"]}),e.jsxs("button",{type:"button",className:"btn-primary",onClick:()=>l(!0),children:[e.jsx(v,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),"New Project"]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"max-w-md",children:[e.jsx("label",{htmlFor:"search",className:"sr-only",children:"Search projects"}),e.jsx("input",{type:"text",name:"search",id:"search",className:"input",placeholder:"Search projects...",value:a,onChange:t=>w(t.target.value)})]})}),d?e.jsxs("div",{className:"bg-error-50 dark:bg-error-900/20 border border-error-200 dark:border-error-800 rounded-md p-4",children:[e.jsx("p",{className:"text-sm text-error-700 dark:text-error-300",children:d instanceof Error?d.message:"Failed to load projects"}),e.jsx("button",{type:"button",onClick:()=>S(),className:"mt-2 text-sm font-medium text-error-800 dark:text-error-200 hover:text-error-900 dark:hover:text-error-100",children:"Try again"})]}):j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(b,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:a?"No projects found":"No projects yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:a?"Try adjusting your search terms.":"Get started by creating your first log analysis project."}),!a&&e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"button",className:"btn-primary",onClick:()=>l(!0),children:[e.jsx(v,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),"Create Project"]})})]}):e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:j.map(t=>(console.log("Projects: Rendering project card for:",{id:t.id,name:t.name,type:t.project_type,hasId:!!t.id,idType:typeof t.id}),e.jsx($,{to:`/projects/${t.id}`,className:"card hover:shadow-md transition-shadow group",onClick:()=>{console.log("Projects: Clicking project:",{id:t.id,name:t.name,navigationTarget:`/projects/${t.id}`})},children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(b,{className:"h-6 w-6 text-primary-600 group-hover:text-primary-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 truncate",children:t.name}),t.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2",children:t.description})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{children:["Created ",new Date(t.created_at).toLocaleDateString()]}),t.project_type&&e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.project_type==="cli"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:t.project_type.toUpperCase()})]}),t.analysis_count!==void 0&&e.jsxs("span",{children:[t.analysis_count," analyses"]})]})})]})},t.id)))}),k&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:y}),e.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-bottom transition-all transform bg-white dark:bg-gray-800 rounded-lg shadow-xl sm:my-8 sm:align-middle sm:w-full",children:[e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4",children:"Create New Project"}),e.jsxs("div",{className:"mt-2 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Project Name *"}),e.jsx("input",{type:"text",id:"project-name",className:"input",placeholder:"Enter project name",value:s.name,onChange:t=>c({...s,name:t.target.value}),disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project-description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description (optional)"}),e.jsx("textarea",{id:"project-description",rows:3,className:"input",placeholder:"Enter project description",value:s.description,onChange:t=>c({...s,description:t.target.value}),disabled:i})]}),h&&e.jsx("div",{className:"bg-error-50 dark:bg-error-900/20 border border-error-200 dark:border-error-800 rounded-md p-3",children:e.jsx("p",{className:"text-sm text-error-700 dark:text-error-300",children:h})})]})]})}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",className:"btn-primary w-full sm:w-auto sm:ml-3",onClick:E,disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Project"}),e.jsx("button",{type:"button",className:"btn-secondary w-full sm:w-auto sm:ml-3",onClick:y,disabled:i,children:"Cancel"})]})]})]})})]})}export{B as default};
